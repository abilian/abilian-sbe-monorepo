[tool.poetry]
name = "abilian-sbe-next"
version = "0.1.0"
description = ""
authors = ["Abilian SAS <contact@abilian.com>"]

packages = [
  { include = "extranet", from = "src" },
  { include = "abilian", from = "src" },
]


[tool.poetry.dependencies]

# Fix Python version (temporarily) to please the python-poetry-buildpack
# python = "3.9.7"
python = "^3.8"

# Flask and friends
Flask = "^2.0"
Flask-Assets = ">=0.12"
Flask-Mail = ">=0.9.1"
Flask-Migrate = ">=2.0"
Flask-Login = ">=0.4"
Flask-Talisman = ">=0.6"

# Pinned dependencies
Flask-Babel = ">=0.11,<2"
jinja2 = "~3.0"

# We're not ready for SQLAlchemy 1.4 yet (due to sqlalchemy_utils).
sqlalchemy = "~1.3"
# flask-sqlachemy 2.2 breaks our apps.
flask-sqlalchemy = "~2.1"
# flask-sqlalchemy = {git = "https://github.com/pallets/flask-sqlalchemy.git", rev = "f4662ad464a73befa47cf74754fdbfe156570e59"}

# Currently broken w/ 0.13
Flask-WTF = ">=0.12,<0.13"
wtforms = "<2.2"
#Flask-WTF = "*"
#wtforms = "*"

# Currently broken w/ 2.0
webassets = "< 2"

# Forms add-ons
WTForms-Alchemy = ">=0.12"
wtforms-sqlalchemy = "*"

# can parse isoformat / used in a jinja filter
python-dateutil = "^2.4.0"

# Databases / persistence
SQLAlchemy = "^1.1"
alembic = ">=0.9"

# requirement of jinja2; > 0.21 has an important fix for string format. See
# https://github.com/mitsuhiko/markupsafe/issues/28
MarkupSafe = ">=0.21"

# Indexing
Whoosh = "^2.5"

# Task queue
celery = "~5"
redis = "~3"

# Security
bleach = ">=2"
bcrypt = "*"

# low-level tools
deprecated = "*"
hyperlink = "*"

# Used by DeferredJS (TODO: remove)
lxml = "*"

# Used by the logging config loader (TODO: remove)
PyYAML = "*"

# Configuration
toml = "*"

# Used by the connection audit
pygeoip = "*"

# Progres bar, used by some scripts
tqdm = "*"

# Used by the Sentry extension
sentry-sdk = { version="*", extras=["flask"] }

# for debug toolbar
sqlparse = "*"

# antivirus interface
clamd = "*"

# Content detection / transformation
python-magic = "*"
pillow = "*"

# Reporting
pandas = ">=0.17"

#
# Assets management (might not be necessary if distributing compiled assets)
#
jsmin = "*"
cssmin = "*"
closure = "==20161201"
# closure = "*"



# Pinned temporarily
# wtforms = "<2.2"
# flask-babel = "<2"
# itsdangerous = "<2"
# jinja2 = "<3"
# werkzeug = "<1"

# Email validation (when sending digests)
validate_email = "*"

# Language and charset detection
langid = ">=1.1"
chardet = "*"

# Markdown support for Wiki
markdown = "^3"

# needed by folder: export to xls
xlwt = "*"
openpyxl = "^2.3.0"

# Better FP library than itertools IMHO.
toolz = "*"

html2text = "^2020.1.16"


psycopg2-binary = "*"

# Production
gunicorn = "*"
raven = "*"


# Debug tools
rich = "^10.9.0"
icecream = "^2.1.1"
devtools = "*"


# Additional stuff
python-dotenv = "^0.19.0"
flask-env = "*"
importlib-resources = "^5.2.2"
flask-tailwind = "^0.1.4"


[tool.poetry.dev-dependencies]
# Testing
pytest-cov = "*"
pytest-flask = "*"
pytest-xdist = "*"
# pytest-testmon = "^1.2.0"
coveralls = "*"
Flask-LinkTester = "*"
Flask-DebugToolbar = ">=0.10"
profilehooks = "*"
pre-commit = "*"

# Linting
flake8 = "*"
flake8-bugbear = "*"
flake8-comprehensions = "*"
flake8-mutable = "*"
flake8-pytest = "*"
flake8-super-call = "*"
flake8-tidy-imports = "*"
mastool = "*"
mccabe = "*"

# Cleanup / format
isort = "*"
black = "*"

# Deploy
plumbum = "*"
watchgod = "*"
honcho = "*"

# Added later...
html5lib = "*"

# Mypy & friends
mypy = "*"
types-bleach = "*"
types-deprecated = "*"
types-python-dateutil = "*"
types-pytz = "*"
types-pyyaml = "*"
types-redis = "*"
types-requests = "*"
types-setuptools = "*"
types-chardet = "*"
types-Markdown = "*"
safety = "*"
MonkeyType = "*"
pip-audit = "*"
pyanalyze = "^0.5.0"
sqla2uml = "^0.1.1"


[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"


[tool.pytest.ini_options]
filterwarnings = [
    'ignore::DeprecationWarning',
    'ignore::sqlalchemy.exc.SAWarning'
]
