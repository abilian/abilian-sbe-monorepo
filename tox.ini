[tox]
envlist = py38, py39, lint
skipsdist=True

[testenv]
setenv =
  LC_ALL=en_US.UTF-8

passenv =
  SQLALCHEMY_DATABASE_URI

whitelist_externals =
  poetry
  make
  mkdir

commands =
  pip install -U pip setuptools wheel
  poetry install

  # ensure instance dir exists
  mkdir -p -v {toxinidir}/instance

  # run tests
  pytest


[testenv:lint]
skip_install = true

commands =
  pip install -U pip setuptools wheel
  poetry install

  # run linters
  flake8 --version
  make lint
  make test-assets
